<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:icons="clr-namespace:MANDUU.Helpers"
             xmlns:models="clr-namespace:MANDUU.Models"
             x:Class="MANDUU.Views.ShopPages.MyShopPage"
             Title="My Shops">
    <VerticalStackLayout>
        <Grid RowDefinitions="*, auto">
            <CollectionView ItemsSource="{Binding UserShops}" Margin="10"
                            x:Name="ShopCollectionView"
                            SelectionMode="Single"
                            SelectionChangedCommand="{Binding SelectedShopCommand, Mode=TwoWay}"
                            SelectionChangedCommandParameter="{Binding SelectedItem, Source={x:Reference ShopCollectionView}}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="10"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Shop">
                        <Border StrokeThickness="0"
                                StrokeShape="RoundRectangle 10"
                                BackgroundColor="#15008000">
                            <Grid ColumnDefinitions="auto,*,auto">
                                <Border HeightRequest="160"
                                        StrokeThickness="0"
                                        StrokeShape="RoundRectangle 10"
                                        Margin="10"
                                        Grid.Column="0">
                                    <Image Source="{Binding ShopProfileImage}"/>
                                </Border>
                                <Grid Grid.Column="1" HorizontalOptions="Center"
                                      RowDefinitions="auto,auto,*">
                                    <Label Text="{Binding Name}"
                                           FontSize="24"
                                           HorizontalOptions="Center"
                                           Grid.Row="0"/>
                                    <HorizontalStackLayout Grid.Row="1">
                                        <Label Text="{x:Static icons:Icons.locationIcon}"
                                               FontSize=" 24"
                                               FontFamily="MaterialIcon"
                                               TextColor="Gray"/>
                                        <Label Text="{Binding ShortLocation}"
                                               TextColor="Gray"/>
                                    </HorizontalStackLayout>

                                    <Border HorizontalOptions="Center" Padding="5,0"
                                            BackgroundColor="#F615F6"
                                            VerticalOptions="End"
                                            Grid.Row="2"
                                            Margin="0,10"
                                            StrokeShape="RoundRectangle 5"
                                            StrokeThickness="0">
                                        <Border.Shadow>
                                            <Shadow Offset="5,5"
                                                    Opacity="0.5"
                                                    Brush="Gray"/>
                                        </Border.Shadow>

                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding BindingContext.GoToDashboardCommand, Source={x:Reference ShopCollectionView}}" 
                                                                  CommandParameter="{Binding .}"/>

                                        </Border.GestureRecognizers>
                                        <HorizontalStackLayout >
                                            <Label Text="Dashboard"
                                                   VerticalOptions="Center"
                                                   VerticalTextAlignment="Center"
                                                   TextColor="#fff"
                                                   FontSize="20"/>
                                            <Label Text="{x:Static icons:Icons.getStartedIcon}"
                                                   FontFamily="MaterialIcon"
                                                   FontSize="36"
                                                   VerticalTextAlignment="Center"
                                                   TextColor="#fff"/>
                                        </HorizontalStackLayout>
                                    </Border>
                                </Grid>
                                <Label Grid.Column="2"
                                       Text="{x:Static icons:Icons.removeIcon}"
                                       FontFamily="MaterialIcon"
                                       FontSize="24"
                                       FontAttributes="Bold"
                                       TextColor="Red"
                                       Margin="5"
                                       VerticalOptions="Start"
                                       HorizontalOptions="End"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <Border Grid.Row="1" Margin="10" 
                    Background="{StaticResource Primary}"
                    Padding="10,5"
                    StrokeThickness="0"
                    StrokeShape="RoundRectangle 5">
                <Border.Shadow>
                    <Shadow Offset="5,5"
                            Brush="Gray"
                            Opacity="0.5"/>
                </Border.Shadow>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding CreateNewShopCommand}"/>
                </Border.GestureRecognizers>
                <HorizontalStackLayout HorizontalOptions="Center" Spacing="10">
                    <Border StrokeShape="RoundRectangle 100"
                            Stroke="#fff"
                            StrokeThickness="2"
                            HorizontalOptions="Center">
                        <Label Text="+"
                               FontSize="30"
                               Padding="3,-8,4,-3"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"
                               TextColor="#fff"/>                        
                    </Border>
                    <Label Text="Create Shop"
                           VerticalOptions="Center"
                           VerticalTextAlignment="Center"
                           FontSize="20"
                           TextColor="#fff"/>
                </HorizontalStackLayout>
            </Border>
        </Grid>
    </VerticalStackLayout>
</ContentPage>